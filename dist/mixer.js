window.SamJ_Mixer=function(e){function t(){h("LOADING API");for(var e=["https://apis.google.com/js/client.js?onload=onGAPIReady","https://www.youtube.com/iframe_api"],t=0;t<e.length;t++){var n=document.createElement("script");n.src=e[t],document.body.appendChild(n)}}function n(e,t){h("#"+e+" has been pushed to the queue.");var n={};n.id=e,n.start=t.start||0,n.end=t.end||-1,D.push(n)}function o(){if(0===D.length)return h("Empty Queue!","error");if(1===D.length)return h("Add more videos for an optimal experience","warn");if(J.length>=2)return h("Aborting Preload, already a video waiting","warn");if(!G.shuffle&&++b>=D.length)b=0;else for(var e=!1;!e;)b=Math.round(Math.random()*D.length)-1,null!==N&&b===N||(e=!0);b<0&&(b=0),h("Loading Next Video: #"+D[b].id),a(D[b]),N=D[b]}function a(e){var t=document.createElement("div");if(document.getElementById(P).appendChild(t),yt_video=i(e.id),_){_=!1,yt_video.a.className="active",h(e.id);var n=new CustomEvent("FirstVideoLoad",{detail:{video_id:e.id}});document.getElementById(P).dispatchEvent(n)}J.push(yt_video)}function i(e){var t=document.createElement("div");return document.getElementById(P).appendChild(t),new YT.Player(t,{videoId:e,playerVars:{volume:1,controls:0,disablekb:1,iv_load_policy:3,showinfo:0,rel:0,start:video.start,modestbranding:1},events:{onReady:r,onStateChange:u}})}function r(e){A||(e.target.playVideo(),A=!0),J.length<2&&o()}function l(){S=!0,x&&o()}function d(){x=!0,S&&o()}function u(e){return e.data===YT.PlayerState.PLAYING?c(e):e.data===YT.PlayerState.ENDED?s(e):e.data===YT.PlayerState.BUFFERING?g(e):void 0}function s(e){h("Ended "+e.target.getVideoData().title);var t=e.target.getVideoData().video_id;h(t);var e=new CustomEvent("VideoEnded",{detail:{video_id:t}});document.getElementById(P).dispatchEvent(e),e.target.a.outerHTML="",J.splice(0,1),h("Removed "+J[0].getVideoData().title),o()}function c(e){G.playAudio||e.target.mute(),B?m(e):p(e)}function g(e){k=(new Date).getTime(),0!==e.target.getCurrentTime()&&e.target.getCurrentTime()!==D[b].start&&(B=!0,h("Network Issue, Started Buffering...","warn"),null!==C&&(h("Removed Ninty Timer"),clearTimeout(C),C=null),null!==M&&(h("Removed Fade Timer"),clearTimeout(M),M=null),y(!0))}function m(e){B=!1,h("--------------------------"),h("Recovered from network drop"),f(e)}function p(e){console.groupCollapsed("Video Playing"),h("--------------------------"),h("Next Video Started Playing"),R=(new Date).getTime()-k,h("Took "+R+"ms to init next video play"),h("Playing "+e.target.getVideoData().title),f(e);var t=e.target.getVideoData().video_id;h(t);var e=new CustomEvent("NewVideoPlaying",{detail:{video_id:t}});document.getElementById(P).dispatchEvent(e)}function f(t){var n;n=-1!==D[b].end&&D[b].end>D[b].start?D[b].end:t.target.getDuration(),n-=t.target.getCurrentTime();var o=R+I;y(!1),null!==C&&(clearTimeout(C),C=null);var a=1e3*n-o-I;if(C=setTimeout(function(){J.length<=1||(h("Init play of next video"),T=Date.now(),J[1].playVideo())},a),h("Video Overlap @ "+(a/1e3).toString()+"s"),setTimeout(function(){var t=J[1].hasOwnProperty("getPlayerState")?1:0;e.asd=J[t],J[t].setVolume(0)},1500),Y||!Y&&null===M){var i=1e3*n-E;M=setTimeout(function(){var e=J[1].hasOwnProperty("getPlayerState")?1:0,t=1===e?0:1;J[e].a.className="active",J[t].a.className=""},i)}else{var r=J[1].hasOwnProperty("getPlayerState")?1:0,l=1===r?0:1;J[r].a.className="active",J[l].a.className="",console.log(J[l])}h("Fadeout @ "+(i/1e3).toString()+"s"),h("Video Progress: "+t.target.getCurrentTime()),h("Video Length: "+t.target.getDuration()),h("--------------------------"),console.groupEnd("Video Playing")}function y(e){var t=document.getElementsByClassName("bufferImage");if(0===t.length)return console.error("No Buffer Image");for(var n=0;n<t.length;n++)t[n].style.opacity=e?1:0;return w=e}function v(){for(var t in J)J[t].setSize(e.innerWidth,e.innerHeight)}function h(e,t){(V||"error"===t)&&(!1===["info","warn","error"].includes(t)&&(t="info"),console[t]("+ Youtube Seamless: "+e))}var P="overlay",w=!1,E=750,S=!1,I=1e3+E,T=null,_=!0,R=1500,x=!1,V=!0,b=0,A=!1,D=[],N=null,C=null,M=null,J=[],k=null,B=!1,Y=!0;"function"!=typeof console.group&&(console.group=function(e){console.log("--- GROUP STARTED: "+e+"---")}),"function"!=typeof console.groupCollapsed&&(console.groupCollapsed=function(e){console.log("--- GROUP STARTED: "+e+"---")}),"function"!=typeof console.groupEnd&&(console.groupEnd=function(e){console.log("--- GROUP ENDED: "+e+"---")}),function(){var n=["%c Youtube Seamless %cv1 %c https://github.com/SamJUK/youtube-seamless","background: #000000;color: #00ff99","background: #000000;color: #fff",""];console.log.apply(console,n),t(),e.addEventListener("resize",v)}();var G={playlist:{push:n,id:null},onAPIReady:l,startPlayer:d,gapi:{key:null,maxResults:50},debug:h,tVideoVar:J,startImage:null,shuffle:!1,toggleBufferImage:y,windowResized:v,playAudio:!1};return G}(window),function(){window.onYouTubeIframeAPIReady=function(){SamJ_Mixer.debug("API READY"),null===SamJ_Mixer.gapi.key&&SamJ_Mixer.onAPIReady()},window.onGAPIReady=function(){SamJ_Mixer.debug("GAPI READY"),null!==SamJ_Mixer.gapi.key&&(gapi.client.setApiKey(SamJ_Mixer.gapi.key),gapi.client.load("youtube","v3",function(){if(null!==SamJ_Mixer.playlist.id){gapi.client.youtube.playlistItems.list({part:"snippet,contentDetails",playlistId:SamJ_Mixer.playlist.id,maxResults:SamJ_Mixer.gapi.maxResults}).execute(function(e){console.groupCollapsed("Playlist items");for(var t=0;t<e.items.length;t++)SamJ_Mixer.playlist.push(e.items[t].snippet.resourceId.videoId,{start:0,end:-1});console.groupEnd("Playlist items"),SamJ_Mixer.startPlayer()})}}),SamJ_Mixer.onAPIReady())}}();